# MCP Server Configuration

# =============================================================================
# Embedding Provider Configuration
# =============================================================================
# Select embedding provider: "ollama" (default) or "mlx_server"
# MLX Server is 48-161x faster than Ollama on Apple Silicon
EMBEDDING_PROVIDER=ollama

# =============================================================================
# MLX Server Configuration (High-Performance Apple Silicon)
# =============================================================================
# Server: https://github.com/jakedahn/qwen3-embeddings-mlx
# Performance: ~1700 emb/s (vs Ollama ~35 emb/s)
MLX_SERVER_URL=http://localhost:8000
MLX_BATCH_SIZE=64
MLX_TIMEOUT=120
MLX_MODEL_SIZE=small
MLX_FALLBACK_TO_OLLAMA=true

# =============================================================================
# Ollama Configuration (Default Provider)
# =============================================================================
OLLAMA_HOST=http://localhost:11434
OLLAMA_DEFAULT_EMBEDDING_MODEL=nomic-embed-text

# =============================================================================
# Reranker Configuration (Two-Stage RAG)
# =============================================================================
# Enable/disable cross-encoder reranking for improved search accuracy
# Two-stage retrieval: Stage 1 (vector search) -> Stage 2 (reranking)
# Improves search accuracy by 22-31% with ~400ms additional latency
RERANKER_ENABLED=true

# Reranker provider: "transformers" (default), "ollama", or "mlx"
RERANKER_PROVIDER=transformers

# Reranker model (Qwen3-Reranker series recommended)
# Options: Qwen/Qwen3-Reranker-0.6B (fast), Qwen/Qwen3-Reranker-4B, Qwen/Qwen3-Reranker-8B (best quality)
RERANKER_MODEL=Qwen/Qwen3-Reranker-0.6B

# Maximum input length for reranker (query + document)
RERANKER_MAX_LENGTH=512

# Batch size for reranking operations
RERANKER_BATCH_SIZE=8

# Number of candidates to retrieve in Stage 1 for reranking
RERANK_TOP_K=50

# =============================================================================
# Qdrant Configuration
# =============================================================================
QDRANT_HOST=localhost
QDRANT_PORT=6333

# File Processing Configuration
MAX_FILE_SIZE_MB=5
DETECT_BINARY_FILES=true
LOG_SKIPPED_FILES=true
MAX_DIRECTORY_DEPTH=20
FOLLOW_SYMLINKS=false

# Performance Configuration (to be used in later tasks)
INDEXING_CONCURRENCY=4
INDEXING_BATCH_SIZE=20
EMBEDDING_BATCH_SIZE=10
QDRANT_BATCH_SIZE=500

# Memory Management Configuration
MEMORY_WARNING_THRESHOLD_MB=1000
MEMORY_CLEANUP_INTERVAL=5
FORCE_CLEANUP_THRESHOLD_MB=1500

# Database Operation Monitoring Configuration
DB_OPERATION_TIMEOUT=30
DB_RETRY_ATTEMPTS=3
DB_RETRY_DELAY=1.0
DB_HEALTH_CHECK_INTERVAL=50

# MCP Response Management Configuration
MAX_FILES_IN_RESPONSE=50

# Logging Configuration
LOG_LEVEL=INFO
